<div>
    <div class="table-menu">
        <mat-form-field>
            <input
                (keyup)="applyFilter($event.target.value)"
                [disabled]="!data"
                matInput
                autocomplete="off"
                placeholder="Search Results"
            />
        </mat-form-field>
    </div>
    <ng-container>
        <div class="table-container">
            <table [dataSource]="dataSource" mat-table matSort>
                <!-- Configuration Name Column -->
                <ng-container matColumnDef="simulationId">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>ID</th>
                    <td *matCellDef="let result" mat-cell>{{ result.simulationId }}</td>
                </ng-container>

                <ng-container matColumnDef="configuration">
                    <th *matHeaderCellDef mat-header-cell>Configuration</th>
                    <td *matCellDef="let result" mat-cell>
                        {{ result.configuration.name }}
                        <simbad-small-input-action
                            (action)="download(result.configuration.id, result.configuration.name)"
                            [matTooltip]="'simbad.configuration.forms.tooltip.download' | translate"
                            class="btn btn-clear list-action-btn"
                            color="warn"
                            faIcon="download"
                            fontIcon="fa-download"
                            fontSet="fas"
                            matTooltipPosition="after"
                            style="font-size: 11px;"
                        ></simbad-small-input-action>
                    </td>
                </ng-container>

                <ng-container matColumnDef="started">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Started</th>
                    <td *matCellDef="let result" mat-cell>
                        {{ result.startedUtc }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="status">
                    <th *matHeaderCellDef mat-header-cell>Status</th>
                    <td *matCellDef="let result" mat-cell>
                        <ng-container *ngIf="result.cli as cliStatus; else pending">
                            <fa-icon
                                *ngIf="buildIconForStep(cliStatus.status) as iconModel; else pending"
                                [icon]="iconModel.icon"
                                [spin]="iconModel.spin"
                                [pulse]="iconModel.pulse"
                            >
                            </fa-icon>
                        </ng-container>

                        <ng-container *ngIf="result.analyzer as analyzerStatus; else pending">
                            <fa-icon
                                *ngIf="buildIconForStep(analyzerStatus.status) as iconModel; else pending"
                                [icon]="iconModel.icon"
                                [spin]="iconModel.spin"
                                [pulse]="iconModel.pulse"
                            >
                            </fa-icon>
                        </ng-container>

                        <ng-container *ngIf="result.reports as reportsStatus; else pending">
                            <fa-icon
                                *ngIf="buildIconForStep(reportsStatus.status) as iconModel; else pending"
                                [icon]="iconModel.icon"
                                [spin]="iconModel.spin"
                                [pulse]="iconModel.pulse"
                            >
                            </fa-icon>
                        </ng-container>

                        <ng-template #pending>
                            <fa-icon icon="ellipsis-h"></fa-icon>
                        </ng-template>
                    </td>
                </ng-container>

                <ng-container matColumnDef="runtime" *ngIf="{ runtimeMap: runtimeMap$ | async } as data">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Runtime</th>
                    <td *matCellDef="let result" mat-cell>
                        {{ data.runtimeMap[result.simulationId] }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="results">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Results</th>
                    <td *matCellDef="let result" mat-cell>
                        <simbad-small-input-action
                            (action)="download(result.reportId, 'simulation_report.pdf')"
                            [matTooltip]="'simbad.configuration.forms.tooltip.download' | translate"
                            [disabled]="!result.finishedUtc"
                            label=" Report"
                            class="btn btn-clear list-action-btn"
                            color="warn"
                            faIcon="download"
                            fontIcon="fa-download"
                            fontSet="fas"
                            matTooltipPosition="after"
                            style="font-size: 11px;"
                        ></simbad-small-input-action>

                        <simbad-small-input-action
                            (action)="goToModelViewer(result.simulationId)"
                            [matTooltip]="'simbad.configuration.forms.tooltip.download' | translate"
                            [disabled]="!result.finishedUtc"
                            label=" Model"
                            class="btn btn-clear list-action-btn"
                            color="warn"
                            faIcon="eye"
                            fontIcon="fa-eye"
                            fontSet="fas"
                            matTooltipPosition="after"
                            style="font-size: 11px;"
                        ></simbad-small-input-action>
                    </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Actions</th>
                    <td *matCellDef="let result" mat-cell>
                        <simbad-small-input-action
                            (action)="rerun(result.simulationId)"
                            [matTooltip]="'simbad.configuration.forms.tooltip.download' | translate"
                            label=" Rerun"
                            class="btn btn-clear list-action-btn"
                            color="warn"
                            faIcon="redo"
                            fontIcon="fa-redo"
                            fontSet="fas"
                            matTooltipPosition="after"
                            style="font-size: 11px;"
                        ></simbad-small-input-action>

                        <simbad-small-input-action
                            (action)="loadInSimulationPipeline(result.simulationId)"
                            [matTooltip]="'simbad.configuration.forms.tooltip.download' | translate"
                            label=" Monitor"
                            class="btn btn-clear list-action-btn"
                            color="warn"
                            faIcon="external-link-alt"
                            fontIcon="fa-external-link-alt"
                            fontSet="fas"
                            matTooltipPosition="after"
                            style="font-size: 11px;"
                        ></simbad-small-input-action>
                    </td>
                </ng-container>

                <!--                &lt;!&ndash; Title Column &ndash;&gt;-->
                <!--                <ng-container cdkColumnDef="startedUtc" matColumnDef="startedUtc">-->
                <!--                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Status</th>-->
                <!--                    <td *matCellDef="let result" mat-cell>-->
                <!--                        {{ result.cli }} {{result.analyzer}} {{result.reports}}-->
                <!--                    </td>-->
                <!--                </ng-container>-->

                <!--                &lt;!&ndash; Size Column &ndash;&gt;-->
                <!--                <ng-container matColumnDef="sizeKb">-->
                <!--                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Size</th>-->
                <!--                    <td *matCellDef="let artifact" mat-cell>{{ artifact.sizeKb | formatBytes }}</td>-->
                <!--                </ng-container>-->

                <!--                &lt;!&ndash; Actions Column &ndash;&gt;-->
                <!--                <ng-container matColumnDef="actions">-->
                <!--                    <th *matHeaderCellDef mat-header-cell>Actions</th>-->
                <!--                    <td *matCellDef="let artifact" mat-cell>-->
                <!--                        </simbad-small-input-action>-->
                <!--                        <simbad-small-input-action-->
                <!--                                [matTooltip]="'simbad.configuration.forms.tooltip.preview' | translate"-->
                <!--                                class="btn btn-clear list-action-btn"-->
                <!--                                color="warn"-->
                <!--                                faIcon="eye"-->
                <!--                                fontIcon="fa-eye"-->
                <!--                                fontSet="fas"-->
                <!--                                matTooltipPosition="after"-->
                <!--                        >-->
                <!--                        </simbad-small-input-action>-->
                <!--                    </td>-->
                <!--                </ng-container>-->

                <tr *matHeaderRowDef="displayedColumns; sticky: true" mat-header-row></tr>
                <tr *matRowDef="let row; columns: displayedColumns" class="dense-mat-row" mat-row></tr>
            </table>

            <mat-paginator [pageSizeOptions]="[10, 20, 40]" [pageSize]="10" showFirstLastButtons></mat-paginator>
        </div>
    </ng-container>
</div>
